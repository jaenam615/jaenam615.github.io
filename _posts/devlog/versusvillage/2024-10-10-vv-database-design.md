---
title: "versus village: database"
writer: James
date: 2024-10-10 00:01:00 +0900
categories: [devlog, vv]
tags: [devlog, vv, side project]
pin: false
math: true
mermaid: true
image:
  path: /images/2024-10-13-19-18-53.png
---

## 미니 사이드 프로젝트 

최근 이력서, 포트폴리오, 그리고 면접을 준비하느라 공부와 개발에서 자연스레 휴식을 얻었다.  

생각보다 어렵다. 물론 내가 부족한 것에서 기인하겠지만, 현재 내가 당장 노력할 수 있는 부분은 스택 부분이라고 판단했다.  
Node.js 기반 스택을 기준으로 신입채용 하는 곳이 많지는 않았다. Java와 Python이 많아 이 중에 하나는 기본적으로 사용방법은 알아야 되겠다 싶어 Java + Spring으로 미니 프로젝트를 진행하려던 와중에, 정글을 같이 수료한 게임 서버 개발자 강민이와 게임 클라이언트 개발자 성주님이 프로젝트를 진행하려는 것을 알게 되었다. 이 게임을 위한 사이트를 하나 간단하게 만들어 보면서 Java + Spring과 React를 다루고, 최근에 새로 배운 Github Actions와 Docker도 사용해보려고 한다.  

같이 작업하기로 한 게임쪽 두명은 '미니게임 천국'과 비슷한 서비스로 만들려고 한다더라. 우선 하나의 미니게임을 내는 것으로 단기 목표를 잡고, 이후 게임을 추가해 나갈 계획이다. 

## 데이터베이스  

게임 서버쪽 작업을 하는 강민이와 데이터베이스 설계를 함께 했다.  

![db](/images/2024-10-13-19-18-53.png)

우선 이번 프로젝트의 데이터베이스는 MySQL과 MongoDB를 함께 사용하여 관계형과 비관계형 데이터베이스들의 장점을 모두 사용하자고 제안했다. 일단 둘 다 써본 경험이 있어, 둘 간의 장단점, 둘을 함께 사용했을 때 어떤식으로 해야 서비스의 성능이 좋은지, 게임이 추가될 계획이 있기에 확장성 또한 고려해야 하는 점 등등 여러 방면에서 생각해봤을때 이게 난이도는 높을 수 있지만 가장 합당한 선택일거라 판단했다.  

ERD를 그래도 직전 프로젝트 corou에서 만들어본 경험이 있어 내가 강민이에게 알려주는 방식으로 했다.  

게임과 웹 모두에 사용될 엔터티인 사용자, 친구목록, 결제내역, 게임기록, 순위표 엔터티들과 오직 웹사이트에서만 사용될 Forum, 공지, 고객 문의사항 등을 관계형 데이터베이스의 엔터티로 설정했다. 이 중 사용자 정보와 결제 내역은 무결성과 정확성이 그 무엇보다 중요하기에 두말할 필요 없이 관계형 데이터베이스로 관리하기로 했다. 친구목록과 게임기록 또한 Join을 통해 손쉽게 관리가 가능함으로 이쪽에서 관리하는 게 낫다고 판단했다.  

다만, 생각해보니 순위표 자체는 자주 변동이 되는 관계로 NoSQL 데이터베이스를 사용하는 것이 더 적합해 보인다. 관계형 데이터베이스를 사용하면 쓰기 작업이 많은 순위표는 동시성 문제가 발생할 수도 있으며, 이로 인해 쓰기가 지연되는 경우가 빈번하게 발생할 것 같다. 여기에 더해, MongoDB는 데이터를 캐시처럼 활용할 수 있기 때문에 조회 요청 또한 매우 효율적으로 처리할 수 있을 것이다. 그러면 게임 기록을 어떻게 하는지가 관건인데, 개인의 게임 기록중 가장 높은 것을 순위표에 둘 예정이라 이는 여전히 MySQL로 관리하되, 순위표와 연동이 잘 되도록 해야겠다.  

Forum Post와 Comment의 경우 데이터가 정형화되어 있다. Post는 제목, 날짜, 작성자, 내용, 그리고 Comment는 부모 Post, 날짜, 작성자, 내용 정도로 데이터의 구조가 단순하며, 이 구조는 변동 가능성이 없기에 (어쩌면 카테고리정도..?) 관계형 데이터베이스에서 처리하는 것이 좋다고 판단했다. 만약 태그나 다양한 댓글 스레드처럼 무언가가 추가될 가능성이 있었다면 NoSQL을 쓰는 것이 Join도 줄이고 괜찮았겠지만, 게임의 공식 웹사이트 커뮤니티는 일반적으로 그 구조가 단순하기 때문에 이정도로도 충분하다.  





